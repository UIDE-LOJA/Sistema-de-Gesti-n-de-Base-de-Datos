<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>SEMANA 3: Logging/ARIES, checkpoints, crash recovery; journaling, write-ahead log</title>

    <!-- Reveal.js CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/theme/white.css" id="theme">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/monokai.css">

    <!-- UIDE Theme CSS -->
    <link rel="stylesheet" href="../../assets/css/uide-theme.css">

    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="presentacion-clase-semana3.css">

    <!-- Mermaid.js -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- D3.js for advanced visualizations -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>

    <!-- Floating Help Icon -->
    <div class="floating-help-emoji" onclick="showRecoveryInfo()" title="Guía de Recuperación y Logging">
        <i class="fas fa-life-ring"></i>
    </div>

    <div class="reveal">
        <div class="slides">

            <!-- Title Slide -->
            <section data-background-color="#f8f8f8" data-transition="convex">
                <div class="title-slide">
                    <h1><i class="fas fa-database"></i> LTI_05A_300-SGBD-ASC</h1>
                    <h2>SEMANA 3: Logging/ARIES, checkpoints, crash recovery; journaling, write-ahead log</h2>

                    <div class="course-info">
                        <strong>LTI_05A_300-SGBD-ASC</strong> • Quinto Nivel<br>
                        <strong>Sistemas de Gestión de Bases de Datos</strong><br>
                        <em>Prof. Charlie Cárdenas Toledo, M.Sc.</em><br>
                        Universidad Internacional del Ecuador • Noviembre 2025
                    </div>

                    <div style="background: rgba(233, 171, 33, 0.1); border-radius: 8px; padding: 1em; margin: 1em 0; font-size: 0.9em;">
                        <strong>Mecanismos de Persistencia y Recuperación</strong><br>
                        <em>Semana 3 • Logging • WAL • Checkpoints • Algoritmo ARIES</em>
                    </div>

                    <div style="margin-top: 2em; font-size: 0.9em; font-style: italic; color: var(--uide-secondary);">
                        Fundamentos de logging, recuperación ante fallos y algoritmos de última generación
                    </div>
                </div>
            </section>

            <!-- Objetivos -->
            <section data-transition="convex">
                <h2><i class="fas fa-target"></i> Objetivos de la Presentación</h2>
                
                <div class="concept-box">
                    <div class="r-hstack">
                        <div class="column">
                            <div style="background: rgba(40, 167, 69, 0.1); padding: 1rem; border-radius: 8px;">
                                <h5><i class="fas fa-file-alt"></i> Comprender</h5>
                                <p style="font-size: 0.9em;">Los <strong>mecanismos de logging</strong> y Write-Ahead Log (WAL)</p>
                            </div>
                        </div>
                        <div class="column">
                            <div style="background: rgba(35, 53, 110, 0.1); padding: 1rem; border-radius: 8px;">
                                <h5><i class="fas fa-cogs"></i> Dominar</h5>
                                <p style="font-size: 0.9em;">El <strong>algoritmo ARIES</strong> de recuperación de última generación</p>
                            </div>
                        </div>
                    </div>

                    <div class="r-hstack" style="margin-top: 1rem;">
                        <div class="column">
                            <div style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px;">
                                <h5><i class="fas fa-flag-checkered"></i> Analizar</h5>
                                <p style="font-size: 0.9em;">El <strong>rol de los checkpoints</strong> en la sincronización</p>
                            </div>
                        </div>
                        <div class="column">
                            <div style="background: rgba(220, 53, 69, 0.1); padding: 1rem; border-radius: 8px;">
                                <h5><i class="fas fa-tools"></i> Implementar</h5>
                                <p style="font-size: 0.9em;"><strong>Estrategias de recuperación</strong> ante fallos del sistema</p>
                            </div>
                        </div>
                    </div>

                    <div class="r-hstack" style="margin-top: 1rem;">
                        <div class="column" style="text-align: center;">
                            <div style="background: rgba(108, 117, 125, 0.1); padding: 1rem; border-radius: 8px;">
                                <h5><i class="fas fa-shield-alt"></i> Aplicar</h5>
                                <p style="font-size: 0.9em;"><strong>Principios ACID</strong> en persistencia y durabilidad</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Agenda -->
            <section data-transition="convex">
                <h2><i class="fas fa-list"></i> Agenda</h2>
                
                <div class="agenda-container">
                    <div class="agenda-item" data-number="1">
                        <h4>Fundamentos de Logging y Write-Ahead Log (WAL)</h4>
                        <p>Conceptos básicos, estructura y principios</p>
                    </div>
                    
                    <div class="agenda-item" data-number="2">
                        <h4>Algoritmo ARIES: Recuperación de Última Generación</h4>
                        <p>Componentes técnicos y fases de recuperación</p>
                    </div>
                    
                    <div class="agenda-item" data-number="3">
                        <h4>Checkpoints: Puntos de Sincronización</h4>
                        <p>Implementación y optimización</p>
                    </div>
                    
                    <div class="agenda-item" data-number="4">
                        <h4>Recuperación Ante Fallos del Sistema</h4>
                        <p>Estrategias y procesos de recuperación</p>
                    </div>
                    
                    <div class="agenda-item" data-number="5">
                        <h4>Implementación Práctica en SGBD Modernos</h4>
                        <p>Ejemplos en PostgreSQL y Oracle</p>
                    </div>
                </div>
            </section>

            <!-- Importancia Section -->
            <section data-transition="convex">
                <h2><i class="fas fa-exclamation-triangle"></i> Importancia de la Persistencia y Recuperación</h2>
                
                <div class="concept-box">
                    <h4>Contexto Empresarial</h4>
                    <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1em; text-align: center;">
                        "La administración de bases de datos requiere un conocimiento profundo de los mecanismos de respaldo y recuperación para asegurar la continuidad del negocio"
                    </blockquote>

                    <div class="r-hstack" style="margin-top: 2rem;">
                        <div class="column">
                            <h4>Relación con Seguridad</h4>
                            <blockquote style="font-style: italic; color: var(--uide-secondary); font-size: 0.9em;">
                                "La seguridad de la información está estrechamente ligada a los procesos de respaldo y recuperación, que permiten mantener la disponibilidad de los datos incluso después de un fallo"
                            </blockquote>
                        </div>
                        <div class="column">
                            <h4>Propiedades ACID Afectadas</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>Atomicidad</strong>: Transacciones completas o nada</li>
                                <li><strong>Durabilidad</strong>: Persistencia de cambios confirmados</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Logging Section -->
            <section>
                <section data-transition="convex">
                    <h2><i class="fas fa-file-alt"></i> Registro de Operaciones (Logging)</h2>
                    
                    <div class="concept-box">
                        <h4>Definición Fundamental</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1.1em; text-align: center;">
                            "El registro de operaciones, o log, es la técnica más habitual para la recuperación ante caídas del sistema"
                        </blockquote>

                        <div class="r-hstack" style="margin-top: 2rem;">
                            <div class="column">
                                <h4>Características del Log</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Almacenamiento consecutivo</strong>: Cambios aplicados secuencialmente</li>
                                    <li><strong>Estado de transacciones</strong>: Registro del ciclo de vida completo</li>
                                    <li><strong>Almacenamiento estable</strong>: Generalmente en disco</li>
                                    <li><strong>Recuperación confiable</strong>: Base para restauración del sistema</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Función Principal</h4>
                                <div style="background: rgba(40, 167, 69, 0.1); padding: 1rem; border-radius: 8px;">
                                    <p style="font-size: 0.9em; margin: 0;">
                                        Mantener un histórico completo de todas las modificaciones para poder reconstruir el estado de la base de datos tras un fallo.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-list-alt"></i> Estructura de Registros de Log</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Registros de Actualización</h4>
                                <p style="font-size: 0.9em;">Cada entrada debe contener:</p>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Identificador de Transacción</strong>: Qué transacción realizó el cambio</li>
                                    <li><strong>Identificador del Elemento</strong>: Qué dato fue modificado</li>
                                    <li><strong>Valor Anterior (V₁)</strong>: Estado previo del dato</li>
                                    <li><strong>Valor Nuevo (V₂)</strong>: Estado posterior del dato</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Registros de Control de Transacciones</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>&lt;Tᵢ start&gt;</strong>: Inicio de transacción Tᵢ</li>
                                    <li><strong>&lt;Tᵢ commit&gt;</strong>: Confirmación exitosa de Tᵢ</li>
                                    <li><strong>&lt;Tᵢ abort&gt;</strong>: Aborto/cancelación de Tᵢ</li>
                                </ul>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem;">
                            <h4>Ejemplo de Secuencia de Log</h4>
                            <pre><code class="plaintext">
&lt;T1 start&gt;
&lt;T1, X, 100, 150&gt;
&lt;T1, Y, 200, 250&gt;
&lt;T1 commit&gt;
&lt;T2 start&gt;
&lt;T2, Z, 300, 350&gt;
&lt;T2 abort&gt;
                            </code></pre>
                        </div>
                    </div>
                </section>
            </section>

            <!-- WAL Section -->
            <section>
                <section data-transition="convex">
                    <h2><i class="fas fa-forward"></i> Write-Ahead Log (WAL): Concepto Central</h2>
                    
                    <div class="concept-box">
                        <h4>Definición</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1em; text-align: center;">
                            "El Write-Ahead Log (WAL), conocido también como registro anticipado de escritura o bitácora de compromiso (commit log), es una estructura auxiliar de disco de solo anexión (append-only)"
                        </blockquote>

                        <div style="margin-top: 2rem;">
                            <h4>Regla Fundamental del WAL</h4>
                            <blockquote style="font-style: italic; color: var(--uide-secondary); font-size: 0.9em; text-align: center;">
                                "Before a block of data in main memory is output to the database, all log records pertaining to data in that block must have been output to stable storage"
                            </blockquote>
                        </div>

                        <div style="margin-top: 1.5rem;">
                            <h4>Traducción Práctica</h4>
                            <div style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px;">
                                <p style="font-size: 0.9em; margin: 0; text-align: center;">
                                    <strong>Antes</strong> de escribir cualquier cambio al disco, <strong>primero</strong> se debe escribir el registro correspondiente al log en almacenamiento estable.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-lock"></i> Principio WAL: Garantías de Consistencia</h3>
                    
                    <div class="concept-box">
                        <h4>Beneficios del WAL</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1em; text-align: center;">
                            "By logging changes before they are applied, it enables recovery from crashes and maintains consistency"
                        </blockquote>

                        <div class="r-hstack" style="margin-top: 2rem;">
                            <div class="column">
                                <h4>Secuencia de Operaciones</h4>
                                <ol style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Modificación en memoria</strong>: Cambio en buffer/cache</li>
                                    <li><strong>Escritura al log</strong>: Registro en WAL (obligatorio)</li>
                                    <li><strong>Escritura a disco</strong>: Modificación en archivos de datos</li>
                                </ol>
                            </div>
                            <div class="column">
                                <h4>Garantía de Durabilidad</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Log persistente</strong>: Cambios registrados antes de aplicar</li>
                                    <li><strong>Recuperación posible</strong>: Recrear estado desde log</li>
                                    <li><strong>Consistencia mantenida</strong>: No hay cambios "perdidos"</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fab fa-postgresql"></i> WAL en PostgreSQL: Ejemplo Práctico</h3>
                    
                    <div class="concept-box">
                        <h4>Comando EXPLAIN con WAL</h4>
                        <pre><code class="sql">
EXPLAIN (ANALYZE, VERBOSE, BUFFERS, WAL) 
SELECT * FROM public.effective_io_concurrency_test;

-- Resultado:
-- WAL: records=18 bytes=5178
                        </code></pre>

                        <div class="r-hstack" style="margin-top: 1.5rem;">
                            <div class="column">
                                <h4>Información Proporcionada</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Records</strong>: Número de registros de WAL generados</li>
                                    <li><strong>Bytes</strong>: Cantidad de datos escritos al WAL</li>
                                    <li><strong>Utilidad</strong>: Analizar impacto de operaciones en el log</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Interpretación</h4>
                                <div style="background: rgba(35, 53, 110, 0.1); padding: 1rem; border-radius: 8px;">
                                    <p style="font-size: 0.9em; margin: 0;">
                                        Esta información ayuda a entender el costo de operaciones en términos de actividad de logging.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </section>            
<!-- Estrategias de Modificación -->
            <section data-transition="convex">
                <h2><i class="fas fa-exchange-alt"></i> Estrategias de Modificación</h2>
                
                <div class="concept-box">
                    <div class="r-hstack">
                        <div class="column">
                            <div style="background: rgba(40, 167, 69, 0.1); padding: 1rem; border-radius: 8px;">
                                <h4>1. Modificación Diferida</h4>
                                <ul style="font-size: 0.8em; text-align: left; margin: 0.5rem 0;">
                                    <li><strong>Comportamiento</strong>: Solo se anota en el log</li>
                                    <li><strong>Escritura física</strong>: Solo cuando transacción se compromete</li>
                                    <li><strong>Ventaja</strong>: Menor I/O durante ejecución</li>
                                    <li><strong>Riesgo</strong>: Fallo durante escritura requiere undo</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <div style="background: rgba(35, 53, 110, 0.1); padding: 1rem; border-radius: 8px;">
                                <h4>2. Modificación Inmediata</h4>
                                <ul style="font-size: 0.8em; text-align: left; margin: 0.5rem 0;">
                                    <li><strong>Comportamiento</strong>: Escritura inmediata tras logging</li>
                                    <li><strong>Timing</strong>: Antes de confirmación de transacción</li>
                                    <li><strong>Ventaja</strong>: Datos actualizados continuamente</li>
                                    <li><strong>Complejidad</strong>: Requiere mecanismos de undo más sofisticados</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ARIES Section -->
            <section>
                <section data-transition="convex">
                    <h2><i class="fas fa-star"></i> Algoritmo ARIES: Estado del Arte</h2>
                    
                    <div class="concept-box">
                        <h4>Definición</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1.1em; text-align: center;">
                            "ARIES (Algorithm for Recovery and Isolation Exploiting Semantics) es un state of the art recovery method"
                        </blockquote>

                        <div class="r-hstack" style="margin-top: 2rem;">
                            <div class="column">
                                <h4>Innovaciones Clave</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Log Sequence Numbers (LSN)</strong>: Identificación única de registros</li>
                                    <li><strong>Compensation Log Records (CLRs)</strong>: Registro de operaciones undo</li>
                                    <li><strong>DirtyPageTable</strong>: Seguimiento de páginas modificadas</li>
                                    <li><strong>Optimización</strong>: Diseñado para máximo rendimiento</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Diferencias con Métodos Tradicionales</h4>
                                <div style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px;">
                                    <p style="font-size: 0.9em; margin: 0;">
                                        ARIES supera las limitaciones de métodos simplificados mediante estructuras de datos especializadas y algoritmos optimizados.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-cogs"></i> Componentes Técnicos de ARIES</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Log Sequence Numbers (LSN)</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Función</strong>: Identificador único para cada registro del log</li>
                                    <li><strong>Almacenamiento</strong>: Se guardan en páginas de datos</li>
                                    <li><strong>Propósito</strong>: Rastrear qué actualizaciones ya se aplicaron</li>
                                    <li><strong>Beneficio</strong>: Evita reaplicar operaciones ya ejecutadas</li>
                                </ul>

                                <h4>Compensation Log Records (CLRs)</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Función</strong>: Registrar acciones durante fase de undo</li>
                                    <li><strong>Característica</strong>: No necesitan ser deshechas nuevamente</li>
                                    <li><strong>Ventaja</strong>: Evita undo de undo (undo cascading)</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>DirtyPageTable</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Estructura</strong>: Tabla de páginas modificadas en memoria</li>
                                    <li><strong>Contenido</strong>: Páginas que no se han sincronizado al disco</li>
                                    <li><strong>Uso</strong>: Determinar qué páginas necesitan redo</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-redo"></i> ARIES: Las Tres Fases de Recuperación</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Fase 1: Análisis (Analysis Pass)</h4>
                                <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 0.9em;">
                                    "El sistema escanea el log desde el último registro de checkpoint"
                                </blockquote>
                                <p style="font-size: 0.8em;"><strong>Objetivos determinados:</strong></p>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Transacciones incompletas</strong>: Identificar las que necesitan deshacerse</li>
                                    <li><strong>Páginas sucias</strong>: Determinar qué páginas estaban modificadas</li>
                                    <li><strong>RedoLSN</strong>: Punto de inicio para la fase de Redo</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Fase 2: Rehacer (Redo Pass)</h4>
                                <blockquote style="font-style: italic; color: var(--uide-secondary); font-size: 0.9em;">
                                    "Repeats history - Repite la historia"
                                </blockquote>
                                <p style="font-size: 0.8em;"><strong>Proceso:</strong></p>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Aplicar todas las acciones</strong>: Desde RedoLSN hasta final del log</li>
                                    <li><strong>Restaurar estado</strong>: Exactamente como estaba al momento del fallo</li>
                                    <li><strong>Incluye todo</strong>: Cambios confirmados y no confirmados</li>
                                </ul>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem;">
                            <h4>Fase 3: Deshacer (Undo Pass)</h4>
                            <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 0.9em; text-align: center;">
                                "Rolls back all incomplete transactions - Deshace todas las transacciones incompletas"
                            </blockquote>
                            <div class="r-hstack" style="margin-top: 1rem;">
                                <div class="column">
                                    <p style="font-size: 0.8em;"><strong>Metodología:</strong></p>
                                    <ul style="font-size: 0.8em; text-align: left;">
                                        <li><strong>Escaneo hacia atrás</strong>: Desde final del log hacia atrás</li>
                                        <li><strong>Undo-list</strong>: Transacciones identificadas en fase de análisis</li>
                                        <li><strong>CLRs</strong>: Generación de registros de compensación</li>
                                        <li><strong>Resultado</strong>: Solo transacciones confirmadas permanecen</li>
                                    </ul>
                                </div>
                                <div class="column">
                                    <h4>Visualización del Proceso</h4>
                                    <pre><code class="plaintext">
Tiempo ←——————————————————————————————————————————————→
       Antiguo    Último checkpoint    Final (Crash!)    Nuevo
Log:   [......] ←—— Análisis ——→ [....] —— Redo ——→ [....] ←— Undo —
                                    </code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Checkpoints Section -->
            <section>
                <section data-transition="convex">
                    <h2><i class="fas fa-flag-checkered"></i> Checkpoints: Puntos de Sincronización</h2>
                    
                    <div class="concept-box">
                        <h4>Definición y Propósito</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1em; text-align: center;">
                            "Un punto de control (checkpoint) es un evento que ayuda a sincronizar la caché de buffer de la base de datos con los archivos de datos en el disco"
                        </blockquote>

                        <div class="r-hstack" style="margin-top: 2rem;">
                            <div class="column">
                                <h4>Función Principal</h4>
                                <div style="background: rgba(40, 167, 69, 0.1); padding: 1rem; border-radius: 8px;">
                                    <p style="font-size: 0.9em; margin: 0;">
                                        <strong>Reducir trabajo de recuperación</strong> limitando la cantidad de registros del log que deben ser examinados tras un fallo.
                                    </p>
                                </div>
                            </div>
                            <div class="column">
                                <h4>Beneficios</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Marcador de sincronización</strong>: Punto conocido de consistencia</li>
                                    <li><strong>Optimización de recuperación</strong>: Menos log que procesar</li>
                                    <li><strong>Rendimiento</strong>: Operación de baja sobrecarga</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-tools"></i> Implementación de Checkpoints</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Modelo Oracle/Tradicional</h4>
                                <p style="font-size: 0.9em;"><strong>Proceso Checkpoint (CKPT):</strong></p>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Instrucción al DBWR</strong>: Escribir todos los bloques modificados</li>
                                    <li><strong>Actualización de headers</strong>: Archivos de datos, Redo Logs, archivos de control</li>
                                    <li><strong>Sincronización completa</strong>: Garantía de consistencia en disco</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Modelo ARIES (Optimizado)</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Logging de checkpoint</strong>: Se registra en el log</li>
                                    <li><strong>DirtyPageTable incluida</strong>: Lista de páginas modificadas</li>
                                    <li><strong>Transacciones activas</strong>: Estado al momento del checkpoint</li>
                                    <li><strong>No escritura inmediata</strong>: Páginas sucias se vacían continuamente en background</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Recuperación Section -->
            <section>
                <section data-transition="convex">
                    <h2><i class="fas fa-life-ring"></i> Recuperación Ante Fallos: Proceso General</h2>
                    
                    <div class="concept-box">
                        <h4>Objetivo de la Recuperación</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1em; text-align: center;">
                            "Garantizar que la base de datos se restablezca a un estado consistente, asegurando que las transacciones confirmadas persistan y que las no confirmadas sean revertidas"
                        </blockquote>

                        <div class="r-hstack" style="margin-top: 2rem;">
                            <div class="column">
                                <h4>Tipos de Fallos</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Fallo de transacción</strong>: Error en lógica de aplicación</li>
                                    <li><strong>Deadlock</strong>: Bloqueo mutuo de recursos</li>
                                    <li><strong>Error de software/hardware</strong>: Fallo del sistema</li>
                                    <li><strong>Fallo catastrófico</strong>: Pérdida de almacenamiento</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Filosofía de Recuperación</h4>
                                <div style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px;">
                                    <p style="font-size: 0.9em; margin: 0;">
                                        Volver a la normalidad después de un evento inesperado, manteniendo la integridad de los datos.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-redo-alt"></i> Fases de Recuperación: Redo y Undo</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Rolling Forward (Redo)</h4>
                                <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 0.9em;">
                                    "Volver a aplicar a los archivos de datos todas las modificaciones guardadas en el archivo de registro de operaciones"
                                </blockquote>
                                <p style="font-size: 0.8em;"><strong>En Oracle:</strong></p>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>SMON (System Monitor)</strong>: Responsable de aplicar redo logs</li>
                                    <li><strong>Objetivo</strong>: Aplicar todas las modificaciones registradas</li>
                                    <li><strong>Resultado</strong>: Archivos contienen cambios confirmados Y no confirmados</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Rolling Back (Undo)</h4>
                                <p style="font-size: 0.8em;"><strong>Después del Redo:</strong></p>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Segmentos de rollback</strong>: Identificar transacciones no confirmadas</li>
                                    <li><strong>PMON (Process Monitor)</strong>: Detecta errores de proceso de usuario</li>
                                    <li><strong>Acciones</strong>: Deshacer cambios, liberar bloqueos y recursos</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-database"></i> Recuperación Completa en Oracle: Ejemplo</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Secuencia de Recuperación</h4>
                                <ol style="font-size: 0.8em; text-align: left;">
                                    <li><strong>Restauración</strong>: Recuperar respaldo más reciente</li>
                                    <li><strong>Redo</strong>: Aplicar cambios usando redo logs</li>
                                    <li><strong>Apertura</strong>: Cambiar base de datos a estado OPEN</li>
                                    <li><strong>Undo</strong>: Aplicar rollback para datos no confirmados</li>
                                    <li><strong>Éxito</strong>: Archivos recuperados y consistentes</li>
                                </ol>
                            </div>
                            <div class="column">
                                <h4>Estados de la Base de Datos</h4>
                                <ul style="font-size: 0.8em; text-align: left;">
                                    <li><strong>NOMOUNT</strong>: Cargar archivos de parámetros</li>
                                    <li><strong>MOUNT</strong>: Localizar archivos de control</li>
                                    <li><strong>OPEN</strong>: Acceso normal de usuarios</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Diagrama de Estados -->
            <section data-transition="convex">
                <h2><i class="fas fa-sitemap"></i> Diagrama de Estados de Recuperación</h2>
                
                <div class="concept-box">
                    <div class="mermaid">
                        graph TD
                            A[Inicio] --> B{Cargar configuración respaldos}
                            B --> C{Verificar datos servidor redundante}
                            C --> D{Verificar respaldo completo BD}
                            D -->|Éxito| E[Estado NOMOUNT FORCE]
                            E --> F[Reiniciar BD - Estado NOMOUNT]
                            F --> G[Estado MOUNT]
                            G --> H[Recuperar base de datos]
                            H --> I[Estado OPEN]
                            I --> J{Generar bitácora proceso}
                            J --> Fin
                            
                            D -->|Error| K{Generar bitácora errores}
                            K --> L[Enviar notificaciones]
                            L --> Fin

                            subgraph "Procesos de Recuperación"
                                E --> R1[Restaurar archivo parámetros]
                                F --> R2[Restaurar archivo control]
                                G --> R3[Restaurar base de datos]
                            end
                    </div>
                </div>
            </section>

            <!-- Ejemplo Práctico PostgreSQL -->
            <section>
                <section data-transition="convex">
                    <h2><i class="fab fa-postgresql"></i> Ejemplo Práctico: Análisis de WAL en PostgreSQL</h2>
                    
                    <div class="concept-box">
                        <h4>Consulta de Impacto</h4>
                        <pre><code class="sql">
-- Analizar actividad WAL de una consulta
EXPLAIN (ANALYZE, VERBOSE, BUFFERS, WAL) 
UPDATE employees 
SET salary = salary * 1.1 
WHERE department = 'Engineering';

-- Resultado típico:
-- WAL: records=245 bytes=15420
-- Buffers: shared hit=1205 read=15 written=8
                        </code></pre>

                        <div style="margin-top: 1.5rem;">
                            <h4>Interpretación del Resultado</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>245 registros</strong>: Número de entradas WAL generadas</li>
                                <li><strong>15420 bytes</strong>: Volumen de datos de logging</li>
                                <li><strong>Implicación</strong>: Costo de la operación en términos de logging</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section data-transition="convex">
                    <h3><i class="fas fa-cog"></i> Configuración WAL en PostgreSQL</h3>
                    
                    <div class="concept-box">
                        <div class="r-hstack">
                            <div class="column">
                                <h4>Parámetros Clave</h4>
                                <pre><code class="sql">
-- Ver configuración actual
SHOW wal_level;                -- Nivel de detalle del WAL
SHOW checkpoint_segments;      -- Frecuencia de checkpoints
SHOW wal_buffers;             -- Tamaño de buffers WAL

-- Configuración recomendada para alta disponibilidad
ALTER SYSTEM SET wal_level = 'replica';
ALTER SYSTEM SET checkpoint_completion_target = 0.9;
ALTER SYSTEM SET wal_buffers = '16MB';
                                </code></pre>
                            </div>
                            <div class="column">
                                <h4>Monitoreo de WAL</h4>
                                <pre><code class="sql">
-- Ver estado actual del WAL
SELECT pg_current_wal_lsn();
SELECT pg_wal_lsn_diff(pg_current_wal_lsn(), '0/0');

-- Estadísticas de checkpoints
SELECT * FROM pg_stat_bgwriter;
                                </code></pre>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Métricas de Rendimiento -->
            <section data-transition="convex">
                <h2><i class="fas fa-chart-line"></i> Métricas de Rendimiento y Optimización</h2>
                
                <div class="concept-box">
                    <h4>Indicadores Clave de WAL</h4>
                    
                    <table style="width: 100%; font-size: 0.7em; margin-top: 1rem;">
                        <thead>
                            <tr>
                                <th>Métrica</th>
                                <th>Descripción</th>
                                <th>Valor Objetivo</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>WAL Records/sec</strong></td>
                                <td>Registros generados por segundo</td>
                                <td>&lt; 10,000</td>
                            </tr>
                            <tr>
                                <td><strong>WAL Bytes/sec</strong></td>
                                <td>Bytes escritos al WAL</td>
                                <td>&lt; 50MB/s</td>
                            </tr>
                            <tr>
                                <td><strong>Checkpoint frequency</strong></td>
                                <td>Frecuencia de checkpoints</td>
                                <td>5-15 min</td>
                            </tr>
                            <tr>
                                <td><strong>Recovery time</strong></td>
                                <td>Tiempo de recuperación</td>
                                <td>&lt; 5 min</td>
                            </tr>
                        </tbody>
                    </table>

                    <div style="margin-top: 1.5rem;">
                        <h4>Optimizaciones Comunes</h4>
                        <ul style="font-size: 0.8em; text-align: left;">
                            <li><strong>Batch operations</strong>: Reducir número de transacciones pequeñas</li>
                            <li><strong>Checkpoint tuning</strong>: Ajustar frecuencia según carga</li>
                            <li><strong>WAL compression</strong>: Habilitar compresión cuando disponible</li>
                            <li><strong>Storage optimization</strong>: SSD para WAL, HDD para datos</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Casos de Uso -->
            <section data-transition="convex">
                <h2><i class="fas fa-briefcase"></i> Casos de Uso y Aplicaciones</h2>
                
                <div class="concept-box">
                    <div class="r-hstack">
                        <div class="column">
                            <h4>Casos Críticos para WAL/ARIES</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>Sistemas financieros</strong>: Transacciones que no pueden perderse</li>
                                <li><strong>E-commerce</strong>: Órdenes de compra y pagos</li>
                                <li><strong>Sistemas médicos</strong>: Historiales críticos de pacientes</li>
                                <li><strong>ERP empresarial</strong>: Operaciones de negocio fundamentales</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h4>Sectores de Aplicación</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>Banca y finanzas</strong>: Cumplimiento regulatorio</li>
                                <li><strong>Telecomunicaciones</strong>: Facturación y servicios</li>
                                <li><strong>Manufactura</strong>: Control de inventario y producción</li>
                                <li><strong>Gobierno</strong>: Registros públicos y servicios ciudadanos</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Comparación de Estrategias -->
            <section data-transition="convex">
                <h2><i class="fas fa-balance-scale"></i> Comparación de Estrategias de Recuperación</h2>
                
                <div class="concept-box">
                    <h4>Métodos Tradicionales vs ARIES</h4>
                    
                    <table style="width: 100%; font-size: 0.7em; margin-top: 1rem;">
                        <thead>
                            <tr>
                                <th>Aspecto</th>
                                <th>Métodos Tradicionales</th>
                                <th>ARIES</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Identificación</strong></td>
                                <td>Números secuenciales simples</td>
                                <td>LSN sofisticados</td>
                            </tr>
                            <tr>
                                <td><strong>Undo handling</strong></td>
                                <td>Undo de undo posible</td>
                                <td>CLRs previenen cascading</td>
                            </tr>
                            <tr>
                                <td><strong>Performance</strong></td>
                                <td>Recuperación lenta</td>
                                <td>Optimizado para velocidad</td>
                            </tr>
                            <tr>
                                <td><strong>Complexity</strong></td>
                                <td>Relativamente simple</td>
                                <td>Más complejo pero eficiente</td>
                            </tr>
                            <tr>
                                <td><strong>Industry adoption</strong></td>
                                <td>Legacy systems</td>
                                <td>Estándar moderno</td>
                            </tr>
                        </tbody>
                    </table>

                    <div style="margin-top: 1.5rem;">
                        <h4>Selección de Estrategia</h4>
                        <ul style="font-size: 0.8em; text-align: left;">
                            <li><strong>Sistemas legacy</strong>: Métodos tradicionales pueden ser suficientes</li>
                            <li><strong>Sistemas modernos</strong>: ARIES es prácticamente estándar</li>
                            <li><strong>Alta disponibilidad</strong>: ARIES obligatorio</li>
                            <li><strong>Sistemas simples</strong>: Evaluación caso por caso</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Tendencias -->
            <section data-transition="convex">
                <h2><i class="fas fa-crystal-ball"></i> Tendencias y Evolución</h2>
                
                <div class="concept-box">
                    <div class="r-hstack">
                        <div class="column">
                            <h4>Desarrollos Modernos</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>WAL-E y WAL-G</strong>: Herramientas de backup continuo</li>
                                <li><strong>Logical replication</strong>: Replicación basada en cambios lógicos</li>
                                <li><strong>Cloud-native databases</strong>: Adaptación de ARIES para la nube</li>
                                <li><strong>NVMe y persistent memory</strong>: Nuevas tecnologías de almacenamiento</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h4>Desafíos Emergentes</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>Big Data</strong>: Volúmenes masivos de transacciones</li>
                                <li><strong>Distributed databases</strong>: Coordinación entre múltiples nodos</li>
                                <li><strong>Real-time analytics</strong>: Balancear OLTP y OLAP</li>
                                <li><strong>Compliance</strong>: Regulaciones de retención de datos</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Síntesis -->
            <section data-transition="convex">
                <h2><i class="fas fa-search"></i> Síntesis: Principios Fundamentales</h2>
                
                <div class="concept-box">
                    <div class="r-hstack">
                        <div class="column">
                            <h4>Garantías del Sistema de Logging</h4>
                            <ol style="font-size: 0.8em; text-align: left;">
                                <li><strong>Durabilidad</strong>: Cambios confirmados nunca se pierden</li>
                                <li><strong>Atomicidad</strong>: Transacciones completas o totalmente revertidas</li>
                                <li><strong>Consistencia</strong>: Estado válido en todo momento</li>
                                <li><strong>Eficiencia</strong>: Recuperación rápida y optimizada</li>
                            </ol>
                        </div>
                        <div class="column">
                            <h4>Implementación Exitosa</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>WAL correctamente configurado</strong>: Base de la confiabilidad</li>
                                <li><strong>Checkpoints optimizados</strong>: Balance entre rendimiento y recuperación</li>
                                <li><strong>ARIES cuando sea posible</strong>: Aprovecha décadas de investigación</li>
                                <li><strong>Monitoreo continuo</strong>: Detectar problemas antes que impacten</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Para Profundizar -->
            <section data-transition="convex">
                <h2><i class="fas fa-graduation-cap"></i> Para Profundizar</h2>
                
                <div class="concept-box">
                    <div class="r-hstack">
                        <div class="column">
                            <h4>Herramientas de Análisis</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>pg_waldump</strong>: Análisis de archivos WAL en PostgreSQL</li>
                                <li><strong>Oracle LogMiner</strong>: Análisis de redo logs en Oracle</li>
                                <li><strong>MongoDB Oplog</strong>: Equivalent en bases NoSQL</li>
                            </ul>
                            
                            <h4>Recursos Técnicos</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>PostgreSQL documentation</strong>: WAL internals</li>
                                <li><strong>Oracle Recovery Manager</strong>: Documentación RMAN</li>
                                <li><strong>Research papers</strong>: ARIES original paper (Mohan et al.)</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h4>Certificaciones Relevantes</h4>
                            <ul style="font-size: 0.8em; text-align: left;">
                                <li><strong>Oracle DBA</strong>: Recovery and backup specialization</li>
                                <li><strong>PostgreSQL</strong>: Advanced administration</li>
                                <li><strong>SQL Server</strong>: Database administration track</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reflexiones Finales -->
            <section data-transition="convex">
                <h2><i class="fas fa-lightbulb"></i> Reflexiones Finales</h2>
                
                <div class="concept-box">
                    <h4>Preguntas para Considerar</h4>
                    <ul style="font-size: 0.9em; text-align: left;">
                        <li>¿Cómo <strong>balancear</strong> rendimiento de logging vs tiempo de recuperación?</li>
                        <li>¿Qué <strong>estrategias</strong> usar para sistemas distribuidos modernos?</li>
                        <li>¿Cómo <strong>evolucionar</strong> sistemas legacy hacia ARIES?</li>
                    </ul>

                    <div style="margin-top: 2rem;">
                        <h4>Desafío Profesional</h4>
                        <blockquote style="font-style: italic; color: var(--uide-primary); font-size: 1.1em; text-align: center;">
                            "La robustez de un sistema de base de datos se mide no por su rendimiento en condiciones normales, sino por su capacidad de recuperación ante fallos inesperados"
                        </blockquote>
                    </div>
                </div>
            </section>

            <!-- Thank You -->
            <section data-transition="convex">
                <h2>¡Gracias por su Participación!</h2>
                <div class="concept-box">
                    <div style="text-align: center; padding: 2rem;">
                        <h4 style="color: var(--uide-primary);"><i class="fas fa-database"></i> LTI_05A_300-SGBD-ASC</h4>
                        <p style="font-size: 1.1em; margin: 1rem 0;">
                            <strong>Semana 3 completada</strong>
                        </p>
                        <p style="font-size: 0.9em; color: var(--uide-secondary);">
                            Prof. Charlie Cárdenas Toledo, M.Sc.<br>
                            Universidad Internacional del Ecuador
                        </p>
                    </div>

                    <div class="interactive-box" style="margin-top: 1rem;">
                        <p><i class="fas fa-question-circle"></i> <strong>¿Preguntas?</strong> Este es el momento para aclarar dudas</p>
                    </div>

                    <div style="margin-top: 1.5rem; font-size: 0.8em; font-style: italic; color: var(--uide-secondary); text-align: center;">
                        <em>Presentación basada en el Compendio Exhaustivo sobre Mecanismos de Persistencia y Recuperación: Logging, WAL, Checkpoints y ARIES - Semana 3, LTI_05A_300-SGBD-ASC</em>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- Reveal.js JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/highlight.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/math/math.js"></script>

    <!-- Custom JavaScript -->
    <script src="presentacion-clase-semana3.js"></script>

    <script>
        // Initialize Reveal.js
        Reveal.initialize({
            hash: true,
            transition: 'convex',
            transitionSpeed: 'default',
            backgroundTransition: 'fade',
            
            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX]
        });

        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#23356e',
                primaryTextColor: '#333',
                primaryBorderColor: '#e9ab21',
                lineColor: '#666',
                secondaryColor: '#e9ab21',
                tertiaryColor: '#f8f8f8'
            }
        });
    </script>

</body>

</html>